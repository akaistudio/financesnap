<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FinanceSnap ‚Äî Business Command Center</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Inter',sans-serif;background:#0f172a;color:#e2e8f0;min-height:100vh}

        /* Topbar */
        .topbar{background:linear-gradient(135deg,#1e293b,#0f172a);border-bottom:1px solid #334155;padding:14px 24px;display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:100}
        .topbar h1{font-size:22px;font-weight:800;color:#fff}.topbar h1 span{background:linear-gradient(135deg,#60a5fa,#a78bfa);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
        .topbar-right{display:flex;align-items:center;gap:8px}
        .topbar-right a{font-size:13px;color:#cbd5e1;text-decoration:none;padding:7px 12px;border-radius:8px;transition:.2s}
        .topbar-right a:hover{background:#334155;color:#fff}

        /* Main */
        .main{max-width:1200px;margin:0 auto;padding:24px}

        /* Connected Apps Bar */
        .apps-bar{display:flex;gap:8px;margin-bottom:24px;flex-wrap:wrap}
        .app-pill{display:flex;align-items:center;gap:6px;padding:6px 14px;border-radius:8px;font-size:12px;font-weight:600;border:1px solid #334155;background:#1e293b}
        .app-pill.connected{border-color:#4ade80;color:#4ade80}.app-pill.connected:hover{background:#0f2a1f;border-color:#22c55e}
        .app-pill.disconnected{border-color:#475569;color:#64748b}
        .app-pill .dot{width:7px;height:7px;border-radius:50%;background:currentColor}

        /* P&L Hero */
        .hero{display:grid;grid-template-columns:1fr 1fr 1fr;gap:20px;margin-bottom:24px}
        .hero-card{background:#1e293b;border:1px solid #475569;border-radius:16px;padding:28px;position:relative;overflow:hidden;transition:.2s}
        .hero-card:hover{border-color:#60a5fa;transform:translateY(-2px)}
        .hero-card::before{content:'';position:absolute;top:0;left:0;right:0;height:4px}
        .hero-card.revenue::before{background:linear-gradient(90deg,#4ade80,#22c55e)}
        .hero-card.expense::before{background:linear-gradient(90deg,#f87171,#fb923c)}
        .hero-card.profit::before{background:linear-gradient(90deg,#60a5fa,#a78bfa)}
        .hero-card .label{font-size:13px;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:#94a3b8;margin-bottom:6px}
        .hero-card .amount{font-size:34px;font-weight:800;color:#fff}
        .hero-card .sub{font-size:14px;color:#cbd5e1;margin-top:6px}
        .hero-card .amount.green{color:#4ade80}.hero-card .amount.red{color:#f87171}
        .hero-card .amount.blue{color:#93c5fd}

        /* Grid */
        .grid-2{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:24px}
        .grid-3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:20px;margin-bottom:24px}

        /* Cards */
        .card{background:#1e293b;border:1px solid #475569;border-radius:14px;padding:22px}
        .card h3{font-size:14px;font-weight:700;color:#cbd5e1;text-transform:uppercase;letter-spacing:.5px;margin-bottom:16px;display:flex;align-items:center;justify-content:space-between}
        .card h3 .badge{font-size:11px;padding:4px 10px;border-radius:6px;background:#334155;color:#cbd5e1;font-weight:600}

        /* Stat rows */
        .stat-row{display:flex;justify-content:space-between;padding:10px 0;border-bottom:1px solid #334155;font-size:14px}
        .stat-row:last-child{border:none}.stat-row .label{color:#cbd5e1}.stat-row .value{font-weight:700;color:#f1f5f9}
        .stat-row .value.green{color:#4ade80}.stat-row .value.red{color:#f87171}.stat-row .value.orange{color:#fbbf24}.stat-row .value.blue{color:#93c5fd}

        /* Pipeline */
        .pipeline{display:flex;gap:6px;margin-bottom:16px}
        .pipeline-step{flex:1;text-align:center;padding:14px 8px;background:#0f172a;border:1px solid #334155;border-radius:10px;position:relative}
        .pipeline-step .num{font-size:26px;font-weight:800;color:#fff;margin-bottom:2px}
        .pipeline-step .plabel{font-size:11px;color:#94a3b8;font-weight:700;text-transform:uppercase;letter-spacing:.5px}
        .pipeline-step .arrow{position:absolute;right:-14px;top:50%;transform:translateY(-50%);color:#64748b;font-size:18px;z-index:1}
        .pipeline-step:nth-child(1){border-bottom:3px solid #a78bfa}.pipeline-step:nth-child(2){border-bottom:3px solid #60a5fa}
        .pipeline-step:nth-child(3){border-bottom:3px solid #2dd4bf}.pipeline-step:nth-child(4){border-bottom:3px solid #fbbf24}
        .pipeline-step:nth-child(5){border-bottom:3px solid #fb923c}.pipeline-step:nth-child(6){border-bottom:3px solid #4ade80}

        /* Bar chart */
        .chart{display:flex;align-items:flex-end;gap:8px;height:150px;padding-top:10px}
        .chart-bar-group{flex:1;display:flex;flex-direction:column;align-items:center;gap:4px}
        .chart-bars{display:flex;gap:3px;align-items:flex-end;height:120px}
        .chart-bar{width:18px;border-radius:4px 4px 0 0;min-height:3px;transition:.3s}
        .chart-bar.income{background:linear-gradient(180deg,#4ade80,#16a34a)}
        .chart-bar.expense{background:linear-gradient(180deg,#f87171,#dc2626)}
        .chart-bar.payroll{background:linear-gradient(180deg,#fbbf24,#d97706)}
        .chart-label{font-size:11px;color:#94a3b8;font-weight:700}

        /* Progress bar */
        .progress-track{width:100%;height:8px;background:#0f172a;border-radius:4px;overflow:hidden;margin-top:6px;margin-bottom:6px}
        .progress-fill{height:100%;border-radius:4px}

        /* Category bars */
        .cat-row{margin-bottom:12px}.cat-row .cat-header{display:flex;justify-content:space-between;font-size:13px;margin-bottom:4px}
        .cat-row .cat-header .name{color:#cbd5e1;font-weight:500}.cat-row .cat-header .amt{color:#f1f5f9;font-weight:700}
        .cat-bar{width:100%;height:8px;background:#0f172a;border-radius:4px;overflow:hidden}
        .cat-fill{height:100%;border-radius:4px;background:linear-gradient(90deg,#60a5fa,#a78bfa)}

        /* Table */
        table{width:100%;border-collapse:collapse}
        th{padding:10px 12px;text-align:left;font-size:11px;font-weight:700;color:#94a3b8;text-transform:uppercase;border-bottom:1px solid #475569}
        td{padding:10px 12px;font-size:13px;color:#e2e8f0;border-bottom:1px solid #334155}
        .status{display:inline-block;padding:4px 10px;border-radius:12px;font-size:11px;font-weight:700}
        .status.active,.status.paid{background:rgba(74,222,128,.2);color:#4ade80}
        .status.sent,.status.signed{background:rgba(96,165,250,.2);color:#93c5fd}
        .status.draft{background:rgba(148,163,184,.15);color:#cbd5e1}
        .status.overdue{background:rgba(248,113,113,.2);color:#f87171}

        /* Legend */
        .legend{display:flex;gap:20px;margin-top:12px;flex-wrap:wrap}
        .legend-item{display:flex;align-items:center;gap:6px;font-size:12px;color:#cbd5e1;font-weight:500}
        .legend-dot{width:12px;height:12px;border-radius:3px}

        /* Flash */
        .flash{padding:12px 16px;border-radius:10px;font-size:14px;margin-bottom:16px}
        .flash.success{background:rgba(74,222,128,.1);color:#4ade80;border:1px solid rgba(74,222,128,.25)}
        .flash.error{background:rgba(248,113,113,.1);color:#f87171;border:1px solid rgba(248,113,113,.25)}

        /* Empty state */
        .empty{text-align:center;padding:32px;color:#94a3b8}
        .empty a{color:#60a5fa;text-decoration:none;font-weight:600}
        .card h3 a:hover{color:#60a5fa}

        /* Company selector */
        .company-selector{display:flex;align-items:center;gap:12px;margin-bottom:24px;padding:14px 18px;background:#1e293b;border:1px solid #475569;border-radius:12px}
        .company-selector label{font-size:13px;font-weight:700;color:#94a3b8;text-transform:uppercase;letter-spacing:.5px}
        .company-selector select{padding:10px 16px;background:#0f172a;border:1.5px solid #475569;border-radius:8px;color:#fff;font-size:15px;font-weight:600;font-family:'Inter',sans-serif;cursor:pointer;min-width:250px}
        .company-selector select:focus{outline:none;border-color:#60a5fa}
        .company-selector select option{background:#1e293b;color:#e2e8f0}

        @media(max-width:768px){.hero,.grid-2,.grid-3{grid-template-columns:1fr}.pipeline{flex-wrap:wrap}}
    </style>
</head>
<body>
<div class="topbar">
    <h1>Finance<span>Snap</span></h1>
    <div class="topbar-right">
        <a href="/entries">üìù Manual Entries</a>
        {% if user.is_superadmin %}<a href="/admin">üëë Admin</a>{% endif %}
        <a href="/settings">‚öôÔ∏è Settings</a>
        <a href="/logout">Sign out</a>
    </div>
</div>

<div class="main">
    {% with messages = get_flashed_messages(with_categories=true) %}{% for cat, msg in messages %}<div class="flash {{ cat }}">{{ msg }}</div>{% endfor %}{% endwith %}

    <!-- Connected Apps -->
    <div class="apps-bar">
        {% if connections.proposalsnap %}<a href="{{ user.proposalsnap_url }}" target="_blank" class="app-pill connected" style="text-decoration:none"><span class="dot"></span> ProposalSnap ‚Üó</a>
        {% else %}<div class="app-pill disconnected"><span class="dot"></span> ProposalSnap</div>{% endif %}
        {% if connections.contractsnap %}<a href="{{ user.contractsnap_url }}" target="_blank" class="app-pill connected" style="text-decoration:none"><span class="dot"></span> ContractSnap ‚Üó</a>
        {% else %}<div class="app-pill disconnected"><span class="dot"></span> ContractSnap</div>{% endif %}
        {% if connections.invoicesnap %}<a href="{{ user.invoicesnap_url }}" target="_blank" class="app-pill connected" style="text-decoration:none"><span class="dot"></span> InvoiceSnap ‚Üó</a>
        {% else %}<div class="app-pill disconnected"><span class="dot"></span> InvoiceSnap</div>{% endif %}
        {% if connections.expensesnap %}<a href="{{ user.expensesnap_url }}" target="_blank" class="app-pill connected" style="text-decoration:none"><span class="dot"></span> ExpenseSnap ‚Üó</a>
        {% else %}<div class="app-pill disconnected"><span class="dot"></span> ExpenseSnap</div>{% endif %}
        {% if connections.payslipsnap %}<a href="{{ user.payslipsnap_url }}" target="_blank" class="app-pill connected" style="text-decoration:none"><span class="dot"></span> PayslipSnap ‚Üó</a>
        {% else %}<div class="app-pill disconnected"><span class="dot"></span> PayslipSnap</div>{% endif %}
        <a href="/settings" style="font-size:12px;color:#60a5fa;text-decoration:none;padding:8px">Configure ‚Üí</a>
    </div>

    <!-- Company Selector -->
    {% if companies %}
    <div class="company-selector">
        <label>Viewing:</label>
        <select onchange="window.location.href='/?company='+this.value">
            <option value="">All Companies</option>
            {% for c in companies %}
            <option value="{{ c.id }}" {% if selected_company == c.id %}selected{% endif %}>{{ c.name }} ({{ c.home_currency or 'USD' }})</option>
            {% endfor %}
        </select>
    </div>
    {% endif %}

    <!-- P&L Hero -->
    <div class="hero">
        <div class="hero-card revenue" onclick="location.href='/drilldown/invoices?company={{ selected_company }}'" style="cursor:pointer">
            <div class="label">Total Revenue{% if is_filtered %} <span style="font-size:10px;color:#475569">(all companies)</span>{% endif %}</div>
            <div class="amount green">{{ curr }}{{ "{:,.0f}".format(total_revenue) }}</div>
            <div class="sub">{{ curr }}{{ "{:,.0f}".format(total_paid) }} from invoices{% if manual_income > 0 %} + {{ curr }}{{ "{:,.0f}".format(manual_income) }} manual{% endif %}</div>
        </div>
        <div class="hero-card expense" onclick="location.href='/drilldown/expenses?company={{ selected_company }}'" style="cursor:pointer">
            <div class="label">{% if is_filtered %}{{ selected_company_name }} Expenses{% else %}Total Costs{% endif %}</div>
            <div class="amount red">{% if is_filtered %}{% for ec, ev in expense_by_currency.items() %}{{ ec }} {{ "{:,.0f}".format(ev) }}{% if not loop.last %} + {% endif %}{% endfor %}{% if not expense_by_currency %}0{% endif %}{% else %}{{ curr }}{{ "{:,.0f}".format(total_costs) }}{% endif %}</div>
            <div class="sub">{% if is_filtered %}{{ total_expenses|int }} in expenses only{% else %}{% for ec, ev in expense_by_currency.items() %}{{ ec }} {{ "{:,.0f}".format(ev) }}{% if not loop.last %} + {% endif %}{% endfor %}{% if total_payroll_net > 0 %} + {{ curr }}{{ "{:,.0f}".format(total_payroll_net) }} payroll{% endif %}{% endif %}</div>
        </div>
        <div class="hero-card profit">
            <div class="label">Net Profit{% if is_filtered %} <span style="font-size:10px;color:#475569">({{ selected_company_name }})</span>{% endif %}</div>
            <div class="amount {{ 'green' if net_profit >= 0 else 'red' }}">{{ curr }}{{ "{:,.0f}".format(net_profit) }}</div>
            <div class="sub">{% if total_revenue > 0 %}{{ "{:.1f}".format(net_profit/total_revenue*100) }}% margin{% else %}‚Äî{% endif %}</div>
        </div>
    </div>

    <!-- Pipeline -->
    {% if not is_filtered %}
    <div class="card" style="margin-bottom:24px">
        <h3>Business Pipeline <span class="badge">Proposal ‚Üí Contract ‚Üí Invoice ‚Üí Paid</span></h3>
        <div class="pipeline">
            <div class="pipeline-step"><div class="num">{{ pipeline.proposals }}</div><div class="plabel">Proposals</div><span class="arrow">‚Üí</span></div>
            <div class="pipeline-step"><div class="num">{{ pipeline.won }}</div><div class="plabel">Won</div><span class="arrow">‚Üí</span></div>
            <div class="pipeline-step"><div class="num">{{ pipeline.contracts }}</div><div class="plabel">Contracts</div><span class="arrow">‚Üí</span></div>
            <div class="pipeline-step"><div class="num">{{ pipeline.active_contracts }}</div><div class="plabel">Active</div><span class="arrow">‚Üí</span></div>
            <div class="pipeline-step"><div class="num">{{ pipeline.invoices }}</div><div class="plabel">Invoices</div><span class="arrow">‚Üí</span></div>
            <div class="pipeline-step"><div class="num">{{ pipeline.paid_invoices }}</div><div class="plabel">Paid</div></div>
        </div>
    </div>
    {% endif %}

    {% if not is_filtered %}
    <!-- Cash Flow Chart + Revenue Breakdown -->
    <div class="grid-2">
        <div class="card">
            <h3>Monthly Cash Flow <span class="badge">Last 6 months</span></h3>
            <div class="chart">
                {% for m in monthly %}
                <div class="chart-bar-group">
                    <div class="chart-bars">
                        <div class="chart-bar income" style="height:{{ (m.income / max_chart_val * 110)|int }}px" title="{{ curr }}{{ '{:,.0f}'.format(m.income) }}"></div>
                        <div class="chart-bar expense" style="height:{{ (m.expense / max_chart_val * 110)|int }}px" title="{{ curr }}{{ '{:,.0f}'.format(m.expense) }}"></div>
                        <div class="chart-bar payroll" style="height:{{ (m.payroll / max_chart_val * 110)|int }}px" title="{{ curr }}{{ '{:,.0f}'.format(m.payroll) }}"></div>
                    </div>
                    <div class="chart-label">{{ m.label[:3] }}</div>
                </div>
                {% endfor %}
            </div>
            <div class="legend">
                <div class="legend-item"><div class="legend-dot" style="background:#22c55e"></div> Income</div>
                <div class="legend-item"><div class="legend-dot" style="background:#ef4444"></div> Expenses</div>
                <div class="legend-item"><div class="legend-dot" style="background:#f59e0b"></div> Payroll</div>
            </div>
        </div>

        <div class="card">
            <h3><a href="/drilldown/invoices?company={{ selected_company }}" style="color:#cbd5e1;text-decoration:none">Revenue Breakdown ‚Üó</a></h3>
            <div class="stat-row"><span class="label">Invoiced (Total)</span><span class="value">{{ curr }}{{ "{:,.0f}".format(total_invoiced) }}</span></div>
            <div class="stat-row"><span class="label">‚Ü≥ Paid</span><span class="value green">{{ curr }}{{ "{:,.0f}".format(total_paid) }}</span></div>
            <div class="stat-row"><span class="label">‚Ü≥ Unpaid</span><span class="value orange">{{ curr }}{{ "{:,.0f}".format(total_unpaid) }}</span></div>
            <div class="stat-row"><span class="label">‚Ü≥ Overdue</span><span class="value red">{{ curr }}{{ "{:,.0f}".format(total_overdue) }}</span></div>
            <div style="border-top:1px solid #334155;margin-top:8px;padding-top:8px">
                <div class="stat-row"><span class="label">Contract Value (Active)</span><span class="value blue">{{ curr }}{{ "{:,.0f}".format(active_contract_value) }}</span></div>
                <div class="stat-row"><span class="label">Proposal Pipeline</span><span class="value">{{ curr }}{{ "{:,.0f}".format(proposal_value) }}</span></div>
                {% if won_proposals > 0 and total_proposals > 0 %}
                <div class="stat-row"><span class="label">Win Rate</span><span class="value green">{{ "{:.0f}".format(won_proposals/total_proposals*100) }}%</span></div>
                {% endif %}
            </div>
        </div>
    </div>
    {% endif %}

    {% if is_filtered %}
    <!-- Filtered company: show expenses prominently -->
    <div class="card" style="margin-bottom:24px">
        <h3><a href="/drilldown/expenses?company={{ selected_company }}" style="color:#cbd5e1;text-decoration:none">{{ selected_company_name }} ‚Äî Expenses by Category ‚Üó</a></h3>
        {% if expense_cats %}
        {% set max_cat = expense_cats[0][1] if expense_cats else 1 %}
        {% for cat, amt in expense_cats %}
        <div class="cat-row">
            <div class="cat-header"><span class="name">{{ cat }}</span><span class="amt">{% for ec, ev in expense_by_currency.items() %}{{ ec }} {% endfor %}{{ "{:,.0f}".format(amt) }}</span></div>
            <div class="cat-bar"><div class="cat-fill" style="width:{{ (amt/max_cat*100) }}%"></div></div>
        </div>
        {% endfor %}
        {% else %}
        <div class="empty">No expenses for {{ selected_company_name }}</div>
        {% endif %}
    </div>

    <div class="card" style="margin-bottom:24px;background:#0f172a;border-style:dashed">
        <p style="text-align:center;color:#64748b;font-size:13px;padding:12px">Pipeline, Payroll, Invoices and Contracts are shared across all companies. <a href="/" style="color:#60a5fa;text-decoration:none">View All Companies ‚Üí</a></p>
    </div>

    {% else %}
    <!-- Expenses + Payroll + Tax -->
    <div class="grid-3">
        <div class="card">
            <h3><a href="/drilldown/expenses?company={{ selected_company }}" style="color:#cbd5e1;text-decoration:none">Expenses by Category ‚Üó</a></h3>
            {% if expense_cats %}
            {% set max_cat = expense_cats[0][1] if expense_cats else 1 %}
            {% for cat, amt in expense_cats %}
            <div class="cat-row">
                <div class="cat-header"><span class="name">{{ cat }}</span><span class="amt">{{ curr }}{{ "{:,.0f}".format(amt) }}</span></div>
                <div class="cat-bar"><div class="cat-fill" style="width:{{ (amt/max_cat*100) }}%"></div></div>
            </div>
            {% endfor %}
            {% else %}
            <div class="empty">No expenses tracked yet</div>
            {% endif %}
        </div>

        <div class="card">
            <h3><a href="/drilldown/payroll?company={{ selected_company }}" style="color:#cbd5e1;text-decoration:none">Payroll Summary ‚Üó</a></h3>
            <div class="stat-row"><span class="label">Gross Payroll</span><span class="value">{{ curr }}{{ "{:,.0f}".format(total_payroll_gross) }}</span></div>
            <div class="stat-row"><span class="label">Net Payout</span><span class="value green">{{ curr }}{{ "{:,.0f}".format(total_payroll_net) }}</span></div>
            <div class="stat-row"><span class="label">TDS Deducted</span><span class="value orange">{{ curr }}{{ "{:,.0f}".format(total_payroll_tds) }}</span></div>
            <div class="stat-row"><span class="label">PF (EE+ER)</span><span class="value blue">{{ curr }}{{ "{:,.0f}".format(total_payroll_pf) }}</span></div>
        </div>

        <div class="card">
            <h3>Tax Summary</h3>
            <div class="stat-row"><span class="label">GST/Tax Collected</span><span class="value orange">{{ curr }}{{ "{:,.0f}".format(tax_collected) }}</span></div>
            <div class="stat-row"><span class="label">Input Tax (Expenses)</span><span class="value green">{{ curr }}{{ "{:,.0f}".format(tax_on_expenses) }}</span></div>
            <div class="stat-row"><span class="label">Net Tax Liability</span><span class="value {{ 'red' if tax_collected > tax_on_expenses else 'green' }}">{{ curr }}{{ "{:,.0f}".format(tax_collected - tax_on_expenses) }}</span></div>
            <div style="border-top:1px solid #334155;margin-top:8px;padding-top:8px">
                <div class="stat-row"><span class="label">TDS on Salaries</span><span class="value">{{ curr }}{{ "{:,.0f}".format(total_payroll_tds) }}</span></div>
            </div>
        </div>
    </div>

    <!-- Active Contracts + Recent Invoices -->
    <div class="grid-2">
        <div class="card">
            <h3><a href="/drilldown/contracts?company={{ selected_company }}" style="color:#cbd5e1;text-decoration:none">Active Contracts ‚Üó</a> <span class="badge">{{ contracts|length }}</span></h3>
            {% if contracts %}
            <table>
                <thead><tr><th>Title</th><th>Value</th><th>Status</th></tr></thead>
                <tbody>
                {% for c in contracts %}
                <tr>
                    <td><strong>{{ c.title[:35] }}</strong><br><span style="color:#475569;font-size:11px">{{ c.client_name or '' }}</span></td>
                    <td>{{ curr }}{{ "{:,.0f}".format(c.total_value or 0) }}</td>
                    <td><span class="status {{ c.status }}">{{ c.status|capitalize }}</span></td>
                </tr>
                {% endfor %}
                </tbody>
            </table>
            {% else %}<div class="empty">No active contracts. <a href="/settings">Connect ContractSnap ‚Üí</a></div>{% endif %}
        </div>

        <div class="card">
            <h3><a href="/drilldown/invoices?company={{ selected_company }}" style="color:#cbd5e1;text-decoration:none">Recent Invoices ‚Üó</a> <span class="badge">{{ invoices|length }}</span></h3>
            {% if invoices %}
            <table>
                <thead><tr><th>Invoice</th><th>Amount</th><th>Status</th></tr></thead>
                <tbody>
                {% for i in invoices %}
                <tr>
                    <td><strong>{{ i.invoice_number or i.get('number', '-') }}</strong><br><span style="color:#475569;font-size:11px">{{ i.client_name or '' }}</span></td>
                    <td>{{ curr }}{{ "{:,.0f}".format(i.total or 0) }}</td>
                    <td><span class="status {{ i.status }}">{{ i.status|capitalize }}</span></td>
                </tr>
                {% endfor %}
                </tbody>
            </table>
            {% else %}<div class="empty">No invoices. <a href="/settings">Connect InvoiceSnap ‚Üí</a></div>{% endif %}
        </div>
    </div>
    {% endif %}
</div>
</body></html>
